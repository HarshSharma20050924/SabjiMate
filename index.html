<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/logo.svg" />
    <link rel="apple-touch-icon" href="/logo.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>सब्ज़ीMATE</title>
    <link rel="manifest" href="/client-manifest.json">
    <meta name="theme-color" content="#059669">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
      @keyframes zoom-in {
        from { transform: scale(0.5); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
      }
      @keyframes slide-in-left {
        from { transform: translateX(-100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      @keyframes slide-in-right {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      @keyframes slide-in-right-fast {
        from { transform: translateX(100%); }
        to { transform: translateX(0); }
      }
      @keyframes fade-out {
        from { opacity: 1; }
        to { opacity: 0; }
      }
      @keyframes pulse-bg {
        0%, 100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
        50% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
      }
      @keyframes shake {
        10%, 90% { transform: translate3d(-1px, 0, 0); }
        20%, 80% { transform: translate3d(2px, 0, 0); }
        30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
        40%, 60% { transform: translate3d(4px, 0, 0); }
      }
      @keyframes veggie-fade {
        0%, 100% { opacity: 0.2; transform: scale(0.8); }
        50% { opacity: 1; transform: scale(1.2); }
      }
      /* New Animations */
      @keyframes shimmer {
        0% { transform: translateX(-100%) rotate(30deg); }
        100% { transform: translateX(100%) rotate(30deg); }
      }
      @keyframes pulse-gold {
        0%, 100% { transform: scale(1); box-shadow: 0 0 5px rgba(252, 211, 77, 0.5); }
        50% { transform: scale(1.05); box-shadow: 0 0 15px rgba(252, 211, 77, 1); }
      }
      @keyframes celebratory-pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.3); }
        100% { transform: scale(1); }
      }
      @keyframes item-remove {
        from { opacity: 1; transform: scale(1); }
        to { opacity: 0; transform: scale(0.8); }
      }
      @keyframes slide-in-up-subtle {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }
      @keyframes banner-slide-in {
        from { transform: translateY(-100%); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }
      @keyframes listening-pulse {
        0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(234, 88, 12, 0.7); }
        50% { transform: scale(1.02); box-shadow: 0 0 0 10px rgba(234, 88, 12, 0); }
      }
      /* Driver Portal Animations */
      @keyframes pulse-broadcast {
        0%, 100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
        50% { box-shadow: 0 0 0 8px rgba(34, 197, 94, 0); }
      }
      @keyframes checkmark-draw {
        0% { stroke-dashoffset: 25; }
        100% { stroke-dashoffset: 0; }
      }
      @keyframes slide-in-bottom {
        from { transform: translateY(100%); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }

      /* --- Sophisticated Confirmation Overlay Animations (3s lifecycle) --- */
      @keyframes confirmation-backdrop-fade-in-out {
        0% { opacity: 0; }
        10% { opacity: 1; } /* Fade in fast */
        80% { opacity: 1; } /* Hold */
        100% { opacity: 0; } /* Fade out */
      }

      @keyframes confirmation-modal-pop-in-out {
        0% { opacity: 0; transform: scale(0.8); }
        10% { opacity: 1; transform: scale(1.05); } /* Pop in */
        15% { opacity: 1; transform: scale(1); } /* Settle */
        80% { opacity: 1; transform: scale(1); } /* Hold */
        100% { opacity: 0; transform: scale(0.9); } /* Fade out */
      }

      @keyframes draw-circle {
        0% { stroke-dashoffset: 157; } /* circumference of circle with r=25 */
        25% { stroke-dashoffset: 0; }
        100% { stroke-dashoffset: 0; }
      }

      @keyframes draw-tick {
        0% { stroke-dashoffset: 36; } /* length of the tick path */
        20% { stroke-dashoffset: 36; } /* Wait for circle to start drawing */
        45% { stroke-dashoffset: 0; } /* Draw the tick */
        100% { stroke-dashoffset: 0; }
      }

      @keyframes pulse-marker {
        0%, 100% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(22, 163, 74, 0.7);
        }
        70% {
          transform: scale(1.05);
          box-shadow: 0 0 0 10px rgba(22, 163, 74, 0);
        }
      }

      .confirmation-backdrop {
        background-color: rgba(0, 0, 0, 0.4);
        animation: confirmation-backdrop-fade-in-out 3s ease-in-out forwards;
      }

      .confirmation-modal {
        animation: confirmation-modal-pop-in-out 3s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
      }

      .checkmark-circle {
        stroke-dasharray: 157;
        stroke-dashoffset: 157;
        stroke-width: 3;
        stroke: #4CAF50; /* Vibrant Green */
        animation: draw-circle 3s ease-in-out forwards;
      }

      .checkmark-tick {
        stroke-dasharray: 36;
        stroke-dashoffset: 36;
        stroke-width: 4;
        stroke: #4CAF50; /* Vibrant Green */
        stroke-linecap: round;
        stroke-linejoin: round;
        animation: draw-tick 3s ease-in-out forwards;
      }


      .animate-zoom-in { animation: zoom-in 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94) both; }
      .animate-slide-in-left { animation: slide-in-left 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.5s both; }
      .animate-slide-in-right { animation: slide-in-right 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.5s both; }
      .animate-slide-in-right-fast { animation: slide-in-right-fast 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) both; }
      .animate-fade-out { animation: fade-out 0.5s ease-out both; }
      .animate-pulse-bg { animation: pulse-bg 2s infinite; }
      .animate-shake { animation: shake 0.82s cubic-bezier(.36,.07,.19,.97) both; }
      /* New Animation Classes */
      .animate-pulse-gold { animation: pulse-gold 2s infinite cubic-bezier(0.4, 0, 0.6, 1); }
      .animate-celebratory-pulse { animation: celebratory-pulse 0.4s cubic-bezier(0.22, 1, 0.36, 1); }
      .animate-item-remove { animation: item-remove 0.4s ease-out forwards; }
      .animate-slide-in-up-subtle { animation: slide-in-up-subtle 0.5s ease-out both; }
      .animate-banner-slide-in { animation: banner-slide-in 0.6s cubic-bezier(0.25, 1, 0.5, 1) 0.2s both; }
      .animate-listening-pulse { animation: listening-pulse 1.5s infinite ease-in-out; }
      .animate-pulse-marker { animation: pulse-marker 2s infinite; }
      /* Driver Portal Animation Classes */
      .animate-pulse-broadcast { animation: pulse-broadcast 1.5s infinite; }
      .animate-slide-in-bottom { animation: slide-in-bottom 0.5s cubic-bezier(0.25, 1, 0.5, 1) both; }

      .decorated-header {
        position: relative;
        padding-left: 1.25rem; /* 20px */
      }
      .decorated-header::before {
        content: '';
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%);
        width: 12px;
        height: 80%;
        background-image: url("data:image/svg+xml,%3Csvg width='12' height='32' viewBox='0 0 12 32' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M6 0V32' stroke='%2316a34a' stroke-width='2'/%3E%3Cpath d='M10 4C7.79086 4 6 5.79086 6 8C6 10.2091 7.79086 12 10 12' stroke='%23f97316' stroke-width='2' stroke-linecap='round'/%3E%3Cpath d='M2 20C4.20914 20 6 21.7909 6 24C6 26.2091 4.20914 28 2 28' stroke='%23f97316' stroke-width='2' stroke-linecap='round'/%3E%3C/svg%3E%0A");
        background-repeat: no-repeat;
        background-size: contain;
        background-position: center;
      }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "zustand/": "https://aistudiocdn.com/zustand@^5.0.8/",
    "leaflet": "https://aistudiocdn.com/leaflet@^1.9.4",
    "jwt-decode": "https://aistudiocdn.com/jwt-decode@^4.0.0",
    "vite": "https://aistudiocdn.com/vite@^7.1.12",
    "@vitejs/plugin-react": "https://aistudiocdn.com/@vitejs/plugin-react@^5.1.0",
    "path": "https://aistudiocdn.com/path@^0.12.7",
    "url": "https://aistudiocdn.com/url@^0.11.4",
    "express": "https://aistudiocdn.com/express@^5.1.0",
    "bcryptjs": "https://aistudiocdn.com/bcryptjs@^3.0.2",
    "jsonwebtoken": "https://aistudiocdn.com/jsonwebtoken@^9.0.2",
    "passport": "https://aistudiocdn.com/passport@^0.7.0",
    "passport-google-oauth20": "https://aistudiocdn.com/passport-google-oauth20@^2.0.0",
    "express-rate-limit": "https://aistudiocdn.com/express-rate-limit@^8.1.0",
    "ioredis": "https://aistudiocdn.com/ioredis@^5.8.2",
    "@prisma/client": "https://aistudiocdn.com/@prisma/client@^6.18.0",
    "twilio": "https://aistudiocdn.com/twilio@^5.10.4",
    "http": "https://aistudiocdn.com/http@^0.0.1-security",
    "cors": "https://aistudiocdn.com/cors@^2.8.5",
    "dotenv": "https://aistudiocdn.com/dotenv@^17.2.3",
    "multer": "https://aistudiocdn.com/multer@^2.0.2",
    "razorpay": "https://aistudiocdn.com/razorpay@^2.9.6",
    "ws": "https://aistudiocdn.com/ws@^8.18.3",
    "pino": "https://aistudiocdn.com/pino@^10.1.0",
    "vitest/": "https://aistudiocdn.com/vitest@^4.0.5/",
    "vitest": "https://aistudiocdn.com/vitest@^4.0.5",
    "@testing-library/jest-dom/": "https://aistudiocdn.com/@testing-library/jest-dom@^6.9.1/",
    "@testing-library/react": "https://aistudiocdn.com/@testing-library/react@^16.3.0",
    "@testing-library/user-event": "https://aistudiocdn.com/@testing-library/user-event@^14.6.1",
    "cypress": "https://aistudiocdn.com/cypress@^15.5.0",
    "zustand": "https://aistudiocdn.com/zustand@^5.0.8",
    "idb": "https://aistudiocdn.com/idb@^8.0.3",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.28.0",
    "crypto": "https://aistudiocdn.com/crypto@^1.0.1",
    "web-push": "https://aistudiocdn.com/web-push@^3.6.7",
    "recharts": "https://aistudiocdn.com/recharts@^3.3.0",
    "speakeasy": "https://aistudiocdn.com/speakeasy@^2.0.0",
    "qrcode": "https://aistudiocdn.com/qrcode@^1.5.4",
    "zod": "https://aistudiocdn.com/zod@^4.1.12",
    "rate-limit-redis": "https://aistudiocdn.com/rate-limit-redis@^4.3.0"
  }
}
</script>
<script>
  // Initialize deferredPrompt to catch the event if it fires before the React app loads
  window.deferredPrompt = null;
  window.addEventListener('beforeinstallprompt', (e) => {
    // Prevent the mini-infobar from appearing on mobile
    e.preventDefault();
    // Stash the event so it can be triggered later.
    window.deferredPrompt = e;
    console.log('beforeinstallprompt fired globally');
  });
</script>
</head>
  <body class="bg-slate-50 font-['Poppins',_sans-serif]" style="background-image: url('data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%2394e3a5' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');">
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
    <script type="module">
      // Register the service worker for push notifications.
      // Enabled in all environments to allow testing of Push Notifications in Dev.
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw-client.js')
            .then(registration => console.log('Client ServiceWorker registration successful with scope: ', registration.scope))
            .catch(err => console.log('Client ServiceWorker registration failed: ', err));
        });
      }
    </script>
    
    <!-- Razorpay Checkout -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  </body>
</html>